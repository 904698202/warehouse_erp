<!DOCTYPE html>

<html class="app-ui">

<head>
    <!-- Meta -->
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />

    <!-- Document title -->
    <title>仓库管理系统</title>

    <meta name="description" content="AppUI - Admin Dashboard Template & UI Framework" />
    <meta name="author" content="rustheme" />
    <meta name="robots" content="noindex, nofollow" />

    <!-- Favicons -->
    <link rel="apple-touch-icon" href="assets/img/favicons/apple-touch-icon.png" />
    <link rel="icon" href="assets/img/favicons/favicon.ico" />

    <!-- Google fonts -->
    <!-- Page JS Plugins CSS -->
    <link rel="stylesheet" href="assets/js/plugins/slick/slick.min.css" />
    <link rel="stylesheet" href="assets/js/plugins/slick/slick-theme.min.css" />

    <!-- AppUI CSS stylesheets -->
    <link rel="stylesheet" id="css-font-awesome" href="assets/css/font-awesome.css" />
    <link rel="stylesheet" id="css-ionicons" href="assets/css/ionicons.css" />
    <link rel="stylesheet" id="css-bootstrap" href="assets/css/bootstrap.css" />
    <link rel="stylesheet" id="css-app" href="assets/css/app.css" />
    <link rel="stylesheet" id="css-app-custom" href="assets/css/app-custom.css" />
    <!-- End Stylesheets -->
    <style>
        #op{
            padding: 0.8rem;
        }
        tbody>tr{
            display: none;
        }
    </style>
</head>

<body class="app-ui layout-has-drawer layout-has-fixed-header">
<div class="app-layout-canvas">
    <div class="app-layout-container">
        <aside class="app-layout-drawer">

            <!-- Drawer scroll area -->
            <div class="app-layout-drawer-scroll">
                <!-- Drawer logo -->
                <div id="logo" class="drawer-header">
                    <a href="index.html"><img class="img-responsive" src="assets/img/logo/logo-backend.png" title="AppUI" alt="AppUI" /></a>
                </div>

                <!-- Drawer navigation -->
                <nav class="drawer-main">
                    <ul class="nav nav-drawer">

                        <li class="nav-item active">
                            <a href="index.html"><i class="fa fa-home"></i>主页</a>
                        </li>

                        <li class="nav-item nav-item-has-subnav">
                            <a href="javascript:void(0)"><i class="fa fa-user"></i>用户管理</a>
                            <ul class="nav nav-subnav">
                                <li>
                                    <a href="user_list.html">用户信息</i></a>
                                </li>
                            </ul>
                        </li>



                        <li class="nav-item nav-item-has-subnav">
                            <a href="javascript:void(0)"><i class="ion-cube"></i>产品管理</a>
                            <ul class="nav nav-subnav">
                                <li>
                                    <a href="product_list.html">产品列表</a>
                                </li>
                                <li>
                                    <a href="category_list.html">产品类别</a>
                                </li>
                            </ul>
                        </li>

                        <li class="nav-item nav-item-has-subnav">
                            <a href="javascript:void(0)"><i class="ion-ios-albums"></i>仓库管理</a>
                            <ul class="nav nav-subnav">
                                <li>
                                    <a href="storage_list.html">仓库信息</a>
                                </li>
                                <li>
                                    <a href="location_list.html">库位信息</a>
                                </li>
                                <li>
                                    <a href="shelve_list.html">货架信息</a>
                                </li>
                            </ul>
                        </li>

                        <li class="nav-item nav-item-has-subnav">
                            <a href="javascript:void(0)"><i class="ion-person-stalker"></i>顾客管理</a>
                            <ul class="nav nav-subnav">
                                <li>
                                    <a href="customer_list.html">顾客信息</a>
                                </li>
                            </ul>
                        </li>

                    </ul>
                </nav>
                <!-- End drawer navigation -->

                <div class="drawer-footer">
                    <p class="copyright">Copyright &copy; 2021 All rights reserved.</p>
                </div>
            </div>
            <!-- End drawer scroll area -->
        </aside>

        <header class="app-layout-header">
            <nav class="navbar navbar-default">
                <div class="container-fluid">
                    <div class="navbar-header">

                        <span class="navbar-page-title">仓库管理</span>

                    </div>

                    <div class="collapse navbar-collapse" id="header-navbar-collapse">

                        <ul class="nav navbar-nav navbar-right navbar-toolbar hidden-sm hidden-xs">

                            <li class="dropdown dropdown-profile">
                                <a href="javascript:void(0)" data-toggle="dropdown">
                                    <span class="m-r-sm">wuweihan<span class="caret"></span></span>
                                    <img class="img-avatar img-avatar-48" src="assets/img/avatars/avatar3.jpg" alt="User profile pic" />
                                </a>

                                <ul class="dropdown-menu dropdown-menu-right">
                                    <li>
                                        <a href="login.html"><i class="ion-log-out">&nbsp;</i>注销用户</a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                        <!-- .navbar-right -->
                    </div>
                </div>
                <!-- .container-fluid -->
            </nav>
            <!-- .navbar-default -->
        </header>
        <!-- End header -->

        <main class="app-layout-content">

            <div class="row">
                <div class="col-lg-6" style="width: 100%">
                    <!-- Hover Table -->
                    <div class="card">
                        <div class="card-header">
                            <h3>库位信息表</h3>


                            <div style="float: right;display: flex">
                                <input class="form-control" type="text" name="location_name" id="location_name" placeholder="请输入库位名">
                                <input class="form-control" type="text" name="storage_name" id="storage_name" placeholder="请输入所属仓库">
                                <input class="form-control" type="datetime-local" name="begin_time" id="begin_time" title="请选择创建时间范围">
                                <input class="form-control" type="datetime-local" name="end_time" id="end_time" title="请选择创建时间范围">
                                <button type="button" class="btn btn-sm btn-app-outline" onclick="search()">搜索</button>
                                <button type="button" class="btn btn-sm btn-app-outline" onclick="clean()">清空</button>
                                <button class="btn btn-sm btn-app-outline" style="float: right" onclick="createLocation()">新建库位</button>
                            </div>
                        </div>
                        <div class="card-block">
                            <table class="table table-hover">
                                <thead>
                                <tr>
                                    <th class="text-center" style="width: 100px;">编号</th>
                                    <th>库位名</th>
                                    <th>所在仓库</th>
                                    <th>创建时间</th>
                                    <th>最后修改时间</th>
                                    <th>库位状态</th>
                                    <th class="text-center" style="width: 100px;">操作</th>
                                </tr>
                                </thead>
                                <tbody>
                                    <div class="dataTables_paginate paging_simple_numbers">
                                        <ul class="pagination">
                                            <li class="paginate_button previous prev" aria-controls="DataTables_Table_1" tabindex="0">
                                                <a href="#"><i class="ion-ios-arrow-left"></i></a>
                                            </li>
                                            <li class="total" style="pointer-events: none"></li>
                                            <li class="cur_page" style="pointer-events: none"></li>
                                            <li class="paginate_button next" aria-controls="DataTables_Table_1" tabindex="0">
                                                <a href="#"><i class="ion-ios-arrow-right"></i></a>
                                            </li>
                                        </ul>
                                    </div>
                                </tbody>
                    </table>
                        </div>
                        <!-- .card-block -->
                    </div>
                    <!-- .card -->
                    <!-- End Hover Table -->
                </div>
            </div>
        </main>

    </div>
    <!-- .app-layout-container -->
</div>
</div>
<div class="app-ui-mask-modal"></div>
<script src="assets/js/core/jquery.min.js"></script>
<script src="assets/js/core/bootstrap.min.js"></script>
<script src="assets/js/core/jquery.slimscroll.min.js"></script>
<script src="assets/js/core/jquery.scrollLock.min.js"></script>
<script src="assets/js/core/jquery.placeholder.min.js"></script>
<script src="assets/js/app.js"></script>
<script src="assets/js/app-custom.js"></script>

<!-- Page Plugins -->
<script src="assets/js/plugins/slick/slick.min.js"></script>
<script src="assets/js/plugins/chartjs/Chart.min.js"></script>
<script src="assets/js/plugins/flot/jquery.flot.min.js"></script>
<script src="assets/js/plugins/flot/jquery.flot.pie.min.js"></script>
<script src="assets/js/plugins/flot/jquery.flot.stack.min.js"></script>
<script src="assets/js/plugins/flot/jquery.flot.resize.min.js"></script>
<script src="assets/js/url.js"></script>
<script src="assets/js/pages.js"></script>
<script>
    $(function() {
        App.initHelpers('slick');
        search()
    });

    let search = function(){
        let searchDatas = {
            location_name:$("#location_name").val(),
            storage_name:$("#storage_name").val(),
            begin_time:$("#begin_time").val(),
            end_time:$("#end_time").val()
        }
        $("tbody").empty()
        dataFile(searchDatas)
    }

    let clean = function(){
        $("input").val("")
    }

    let createLocation = function(){
        window.open("location_create.html","_self");
    }

    let editLocation = function (id) {
        window.open(`location_edit.html?id=${id}`,'_self');
    }

    let deleteLocation = function (id) {
        if(confirm("是否要弃用该库位？")){
            $.get(buildUrl(`/location/location/delete/id/${id}`),function (response) {
                if (response.code){
                    alert('操作成功！');
                    window.location.replace("location_list.html");
                }
            })
        }
    }

    let createShelve = function(id){
        window.open(`shelve_create.html?shelve_location_id=${id}`,'_self');
    }

    let dataFile = function (searchDatas) {
        $.post(buildUrl('/location/location/index'),searchDatas,function (response) {
            $(response.data).each(function (index,location) {
                if (location.location_delete_time==null && location.storage_delete_time==null){
                    location.location_delete_time = '使用中'
                }else {
                    location.location_delete_time = '已弃用'
                }

                let op = "";
                if (location.location_delete_time == '已弃用'){
                    op ="<button disabled class='op btn btn-xs btn-default' type='button' data-toggle='tooltip' title='编辑'><i class='ion-edit'></i></button>" +
                        "<button disabled class='op btn btn-xs btn-default' type='button' data-toggle='tooltip' title='删除' ><i class='ion-close'></i></button>" +
                        "<button disabled class='op btn btn-xs btn-default' type='button' data-toggle='tooltip' title='新建货架' ><i class='ion-ios-albums'></i></button>";
                }else {
                    op ="<button class='op btn btn-xs btn-default' type='button' data-toggle='tooltip' title='编辑' onclick='editLocation(" + location.location_id + ")'><i class='ion-edit'></i></button>" +
                        "<button class='op btn btn-xs btn-default' type='button' data-toggle='tooltip' title='删除' onclick='deleteLocation(" + location.location_id + ")'><i class='ion-close'></i></button>" +
                        "<button class='op btn btn-xs btn-default' type='button' data-toggle='tooltip' title='新建货架' onclick='createShelve(" + location.location_id + ")'><i class='ion-ios-albums'></i></button>"
                }

                let line = "<tr>" +
                    "<td>" + location.location_id + "</td>" +
                    "<td>" + location.location_name + "</td>" +
                    "<td>" + location.storage_name + "</td>" +
                    "<td>" + location.location_create_time + "</td>" +
                    "<td>" + location.location_update_time + "</td>" +
                    "<td>" + location.location_delete_time + "</td>" +
                    "<td id='op'>" + op + "</td>" +
                    "</tr>";
                $("tbody").append(line);

                var pageParam = {
                    next: '.next',//下一页按钮jq选择器
                    prev: '.prev',//上一页按钮jq选择器
                    nextMore: '.nextMore',//下n页按钮jq选择器
                    prevMore: '.prevMore',//上n页按钮jq选择器
                    totalEl: '.total',//总页数jq元素  元素内包含 eq:“共n页”
                    curPageEl: '.cur_page',//当前页数jq元素  元素内包含 eq:“当前第n页”
                    perPageCount: 7,//每页显示数量
                    morePage: 5//上、下n页跳转数
                }
                $("tbody").page(pageParam);
            })
        })
    }

</script>

<style>
    .copyrights{text-indent:-9999px;height:0;line-height:0;font-size:0;overflow:hidden;}
</style>
</body>

</html>